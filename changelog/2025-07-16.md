# Changelog - 2025-07-16

- [2025-07-16] [Documentation] Performed exhaustive review of cache invalidation across entire codebase
- [2025-07-16] [Documentation] Created comprehensive CACHE_INVALIDATION_REVIEW.md documenting all cache invalidation gaps
- [2025-07-16] [Analysis] Identified that only 2 out of 21 routers (9.5%) implement proper cache invalidation
- [2025-07-16] [Analysis] Found critical missing invalidations in events router (activate, deactivate, execute, resetCounter)
- [2025-07-16] [Analysis] Found complete lack of invalidation in workflows router despite using cached queries
- [2025-07-16] [Analysis] Identified cross-entity cache dependencies that are not being invalidated
- [2025-07-16] [Analysis] Found real-time endpoints (health checks, monitoring) that shouldn't be cached
- [2025-07-16] [Documentation] Provided specific code examples and recommendations for fixing cache invalidation issues
- [2025-07-16] [Planning] Created \_plans/Caching.md - comprehensive plan to simplify caching strategy
- [2025-07-16] [Analysis] Determined that Cronium's CRUD-heavy, real-time nature makes broad caching counterproductive
- [2025-07-16] [Planning] Planned removal of caching from CRUD operations and real-time data
- [2025-07-16] [Planning] Identified selective caching targets: static resources, session data, and rate limiting only
- [2025-07-16] [Refactor] Completed Phase 1.2 of caching simplification - removed all caching from workflows router
- [2025-07-16] [Refactor] Removed cachedQueries.workflowList and cachedQueries.workflowById wrappers
- [2025-07-16] [Refactor] Workflows router now makes direct storage calls for all operations
- [2025-07-16] [Documentation] Created phase-1.2-workflows-router.md summary documenting cache removal from workflows
- [2025-07-16] [Refactor] Completed Phase 1 - removed all caching from CRUD operations across all routers
- [2025-07-16] [Refactor] Events router: removed cachedQueries and cacheInvalidation usage
- [2025-07-16] [Refactor] Dashboard router: removed cachedQueries.dashboardStats wrapper
- [2025-07-16] [Refactor] Jobs router: removed withCache middleware from all endpoints
- [2025-07-16] [Refactor] Monitoring router: removed withCache from base procedure, ensuring real-time health data
- [2025-07-16] [Refactor] Storage layer: removed cache wrapping from getEventWithRelations method
- [2025-07-16] [Refactor] Completed portions of Phase 2 - removed caching from real-time monitoring and job status
- [2025-07-16] [Documentation] Created phase-1-complete-crud-cache-removal.md documenting all Phase 1 changes
- [2025-07-16] [Refactor] Completed Phase 3 - cleaned up cache infrastructure
- [2025-07-16] [Refactor] Removed cachedQueries object from cache middleware
- [2025-07-16] [Refactor] Removed cacheInvalidation helpers from cache middleware
- [2025-07-16] [Refactor] Removed withCache middleware from tRPC configuration
- [2025-07-16] [Refactor] Simplified cache-service.ts - reduced prefixes and TTLs to only essential ones
- [2025-07-16] [Refactor] Updated cache prefixes: kept only USER, RATE_LIMIT, and STATIC
- [2025-07-16] [Refactor] Fixed TypeScript errors from removed cache constants
- [2025-07-16] [Documentation] Updated trpc/README.md to reflect withCache middleware removal
- [2025-07-16] [Documentation] Created phase-3-cache-infrastructure-cleanup.md documenting infrastructure cleanup
- [2025-07-16] Analysis: Created dead code analysis report identifying unused exports including ssh-compat.ts and ppr-config.ts
- [2025-07-16] [Analysis] Created comprehensive technical debt report identifying critical issues in security, performance, and code quality
- [2025-07-16] [Refactor] Completed Phase 4 - implemented selective caching for static resources
- [2025-07-16] [Feature] Created static-resources router for caching script templates and tool configurations
- [2025-07-16] [Feature] Implemented Redis-based session caching with automatic invalidation
- [2025-07-16] [Feature] Replaced in-memory rate limiting with distributed Redis solution
- [2025-07-16] [Feature] Added session cache service with 10-minute TTL and smart revalidation
- [2025-07-16] [Feature] Created rate limit service with fail-open design and status monitoring
- [2025-07-16] [Documentation] Created comprehensive CACHING_STRATEGY.md documentation
- [2025-07-16] [Documentation] Created phase-4-selective-caching.md documenting selective caching implementation
- [2025-07-16] [Refactor] Completed Phase 6 - code cleanup and documentation updates
- [2025-07-16] [Refactor] Cleaned up cache middleware: removed unused imports (cacheHelpers, CACHE_PREFIXES, crypto)
- [2025-07-16] [Refactor] Simplified CacheConfig interface: removed tags, getKey, and getTags fields
- [2025-07-16] [Refactor] Updated withCache function to remove tag support
- [2025-07-16] [Documentation] Archived CACHE_INVALIDATION_ANALYSIS.md with explanation of new caching strategy
- [2025-07-16] [Documentation] Updated ENVIRONMENT_VARIABLES.md with caching strategy notes
- [2025-07-16] [Documentation] Added explanatory comments to events, workflows, and monitoring routers
- [2025-07-16] [Documentation] Created phase-6-code-cleanup.md documenting final cleanup phase
- [2025-07-16] [Documentation] Successfully completed all 6 phases of caching simplification project
- [2025-07-16] [Fix] Fixed Docker volume accumulation issue in development environment by using external named volumes
- [2025-07-16] [Feature] Added setup-dev-volumes.sh script to create persistent development volumes
- [2025-07-16] [Feature] Created alternative docker-compose.dev.host-volumes.yml using host directories instead of Docker volumes
- [2025-07-16] [Configuration] Updated .gitignore to exclude Docker development data directories
- [2025-07-16] [Cleanup] Removed unused files: ssh-compat.ts, ppr-config.ts
- [2025-07-16] [Cleanup] Removed empty test-improved directory
- [2025-07-16] [Bug Fix] Fixed TypeScript type safety issues in events, workflows, and ServerEventsList components
- [2025-07-16] [Documentation] Created cleanup plan for post-migration technical debt
- [2025-07-16] [Documentation] Created phase-1-remove-deprecated-files.md documenting cleanup progress
- [2025-07-16] [Cleanup] Removed unused WorkflowCanvas refactoring files
  - Removed WorkflowCanvas-refactored.tsx (demonstration file not in use)
  - Removed components/ subdirectory with unused sub-components (EmptyCanvasPrompt, EventSidebar, WorkflowToolbar, EventSearch, EventList)
  - Removed hooks/ subdirectory with unused useWorkflowHistory hook
  - Removed validation/ subdirectory with unused workflowValidation module
  - Original WorkflowCanvas.tsx remains in use via WorkflowCanvas-lazy.tsx
- [2025-07-16] [Cleanup] Removed 14 deprecated runtime helper test scripts from src/scripts/deprecated/
- [2025-07-16] [Cleanup] Removed 5 old execution model scripts (scheduler, tool actions)
- [2025-07-16] [Cleanup] Archived 3 completed migration scripts to migrations/archived/
- [2025-07-16] [Cleanup] Removed 4 one-time setup and test database scripts
- [2025-07-16] [Cleanup] Fixed package.json by removing 3 broken migration script commands
- [2025-07-16] [Documentation] Created phase-2-clean-up-scripts.md documenting script cleanup progress
- [2025-07-16] [Testing] Verified all tests updated for containerized execution architecture
- [2025-07-16] [Testing] Confirmed removal of deprecated test patterns (RunLocation.REMOTE, eventServers)
- [2025-07-16] [Testing] Validated comprehensive test coverage for job queue, runtime helpers, and orchestrator
- [2025-07-16] [Documentation] Created phase-3-update-tests.md documenting test verification
- [2025-07-16] [Cleanup] Removed unused utility types from advanced-types.ts (35% file size reduction)
- [2025-07-16] [Cleanup] Kept only actively used exports: type guards, error classes, and conditional types
- [2025-07-16] [Documentation] Created phase-4.1-remove-unused-exports.md documenting type cleanup
- [2025-07-16] [Refactor] Added error logging to 8 critical empty catch blocks
- [2025-07-16] [Feature] Implemented centralized error handling with ErrorHandler class
- [2025-07-16] [Feature] Created standardized API error response formats
- [2025-07-16] [Feature] Added React ErrorBoundary component with recovery support
- [2025-07-16] [Tool] Created script to analyze empty catch blocks across codebase
- [2025-07-16] [Documentation] Created phase-4.4-improve-error-handling.md summary
- [2025-07-16] [Refactor] Updated Next.js page components to use `await params` instead of `await Promise.resolve(params)`
- [2025-07-16] [Refactor] Updated type annotations from `params: { lang: string }` to `params: Promise<{ lang: string }>` in all page components
- [2025-07-16] [Refactor] Standardized params handling across entire application for Next.js 15 compatibility
- [2025-07-16] [Refactor] Updated 3 API route handlers to use Promise-based params pattern
- [2025-07-16] [Refactor] Replaced 9 instances of `Promise.resolve(params)` with direct `await params`
- [2025-07-16] [Refactor] Fixed all remaining components missing Promise types for params
- [2025-07-16] [Refactor] Created centralized authentication middleware with dev mode support
- [2025-07-16] [Feature] Added getFirstAdminUser() with caching to reduce dev mode queries
- [2025-07-16] [Feature] Created reusable database query patterns and utilities
- [2025-07-16] [Feature] Extended error handling with tRPC-specific utilities
- [2025-07-16] [Feature] Implemented standardized API response patterns
- [2025-07-16] [Refactor] Migrated events router to use centralized authentication
- [2025-07-16] [Fix] Removed unused imports and fixed formatting issues
- [2025-07-16] [Documentation] Created phase-4.5-refactor-duplicated-code.md summary
- [2025-07-16] [Feature] Created docker-compose.dev.local-app.yml for running Valkey and cronium-orchestrator in Docker while developing Next.js app locally
- [2025-07-16] [Feature] Added dev-docker-local-app.sh script to manage local development setup with partial containerization
- [2025-07-16] [Configuration] Configured cronium-orchestrator to connect to host machine via host.docker.internal for local Next.js development
- [2025-07-16] [Bug Fix] Fixed TypeScript linting errors in WorkflowExecutionHistory.tsx by adding proper type annotations for tRPC query responses
- [2025-07-16] [Refactor] Migrated all 9 tRPC routers to use standardized authentication patterns
- [2025-07-16] [Refactor] Standardized error handling across all routers using withErrorHandling utility
- [2025-07-16] [Refactor] Implemented consistent API response formats using listResponse, resourceResponse, and mutationResponse
- [2025-07-16] [Tool] Created automated router migration script to apply standardized patterns
- [2025-07-16] [Cleanup] Removed ~1000 lines of duplicated authentication and error handling code
- [2025-07-16] [Documentation] Created router-migration-summary.md documenting the standardization effort
- [2025-07-16] [Refactor] Properly refactored admin router to use imported standardized utilities
- [2025-07-16] [Refactor] Replaced manual error handling with withErrorHandling wrapper in all admin endpoints
- [2025-07-16] [Refactor] Applied standardized response formats (listResponse, resourceResponse, mutationResponse, statsResponse)
- [2025-07-16] [Refactor] Implemented normalizePagination and createPaginatedResult for consistent pagination
- [2025-07-16] [Bug Fix] Fixed undefined pagination references in logs router methods
- [2025-07-16] [Bug Fix] Fixed TypeScript linting errors in console page by properly typing tRPC getAll.useQuery response as ServersResponse
- [2025-07-16] [Bug Fix] Fixed TypeScript linting errors in EventForm.tsx by properly typing server response data and adding null checks
- [2025-07-16] [Bug Fix] Fixed TypeScript linting errors in EventsList.tsx by correctly typing workflow API responses and mapping operations
- [2025-07-16] [Bug Fix] Fixed TypeScript linting errors in EventsListClient.tsx by removing unused imports and fixing unsafe comparisons
- [2025-07-16] [Refactor] Updated EventsList.tsx to properly type workflows response with correct array structure
- [2025-07-16] [Refactor] Fixed BulkActionsToolbar and EventsTable prop mismatches in EventsListClient.tsx
- [2025-07-16] [Refactor] Added proper type assertions for tRPC mutation responses to avoid unsafe member access
- [2025-07-16] [Refactor] Migrated jobs router to use standardized authentication, error handling, and response patterns
- [2025-07-16] [Cleanup] Removed custom authentication contexts (JobContext, AdminMonitoringContext, UserMonitoringContext)
- [2025-07-16] [Bug Fix] Fixed response format mismatches between standardized patterns and frontend expectations
- [2025-07-16] [Refactor] Updated admin.bulkUserOperation to use bulkResponse for frontend compatibility
- [2025-07-16] [Refactor] Modified list responses to return expected format (e.g., {users: [], total: N} instead of {data: {items: []}}
